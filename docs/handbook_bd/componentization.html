<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4.4 Componentization | patRoon handbook</title>
  <meta name="description" content="4.4 Componentization | patRoon handbook" />
  <meta name="generator" content="bookdown 0.19 and GitBook 2.6.7" />

  <meta property="og:title" content="4.4 Componentization | patRoon handbook" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4.4 Componentization | patRoon handbook" />
  
  
  

<meta name="author" content="Rick Helmus" />


<meta name="date" content="2020-08-19" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="annotation.html"/>
<link rel="next" href="processing-workflow-data.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<script src="libs/viz-1.8.2/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.6.1/grViz.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/vis-4.20.1/vis.css" rel="stylesheet" />
<script src="libs/vis-4.20.1/vis.min.js"></script>
<script src="libs/visNetwork-binding-2.0.9/visNetwork.js"></script>
<script src="libs/plotly-binding-4.9.2.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.52.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.52.2/plotly-latest.min.js"></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="installation.html"><a href="installation.html"><i class="fa fa-check"></i><b>2</b> Installation</a><ul>
<li class="chapter" data-level="2.1" data-path="automatic-installation-windows-only.html"><a href="automatic-installation-windows-only.html"><i class="fa fa-check"></i><b>2.1</b> Automatic installation (Windows only)</a></li>
<li class="chapter" data-level="2.2" data-path="manual-installation.html"><a href="manual-installation.html"><i class="fa fa-check"></i><b>2.2</b> Manual installation</a><ul>
<li class="chapter" data-level="2.2.1" data-path="manual-installation.html"><a href="manual-installation.html#r-prerequisites"><i class="fa fa-check"></i><b>2.2.1</b> R prerequisites</a></li>
<li class="chapter" data-level="2.2.2" data-path="manual-installation.html"><a href="manual-installation.html#other-dependencies"><i class="fa fa-check"></i><b>2.2.2</b> Other dependencies</a></li>
<li class="chapter" data-level="2.2.3" data-path="manual-installation.html"><a href="manual-installation.html#patroon-installation"><i class="fa fa-check"></i><b>2.2.3</b> patRoon installation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="workflow-concepts.html"><a href="workflow-concepts.html"><i class="fa fa-check"></i><b>3</b> Workflow concepts</a></li>
<li class="chapter" data-level="4" data-path="generating-workflow-data.html"><a href="generating-workflow-data.html"><i class="fa fa-check"></i><b>4</b> Generating workflow data</a><ul>
<li class="chapter" data-level="4.1" data-path="preparations.html"><a href="preparations.html"><i class="fa fa-check"></i><b>4.1</b> Preparations</a><ul>
<li class="chapter" data-level="4.1.1" data-path="preparations.html"><a href="preparations.html#data-pre-treatment"><i class="fa fa-check"></i><b>4.1.1</b> Data pre-treatment</a></li>
<li class="chapter" data-level="4.1.2" data-path="preparations.html"><a href="preparations.html#anaInfo"><i class="fa fa-check"></i><b>4.1.2</b> Analysis information</a></li>
<li class="chapter" data-level="4.1.3" data-path="preparations.html"><a href="preparations.html#automatic-project-generation-with-newproject"><i class="fa fa-check"></i><b>4.1.3</b> Automatic project generation with newProject()</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="features.html"><a href="features.html"><i class="fa fa-check"></i><b>4.2</b> Features</a><ul>
<li class="chapter" data-level="4.2.1" data-path="features.html"><a href="features.html#finding-and-grouping-features"><i class="fa fa-check"></i><b>4.2.1</b> Finding and grouping features</a></li>
<li class="chapter" data-level="4.2.2" data-path="features.html"><a href="features.html#suspect-screening"><i class="fa fa-check"></i><b>4.2.2</b> Suspect screening</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="annotation.html"><a href="annotation.html"><i class="fa fa-check"></i><b>4.3</b> Annotation</a><ul>
<li class="chapter" data-level="4.3.1" data-path="annotation.html"><a href="annotation.html#ms-peak-lists"><i class="fa fa-check"></i><b>4.3.1</b> MS peak lists</a></li>
<li class="chapter" data-level="4.3.2" data-path="annotation.html"><a href="annotation.html#formulae"><i class="fa fa-check"></i><b>4.3.2</b> Formulae</a></li>
<li class="chapter" data-level="4.3.3" data-path="annotation.html"><a href="annotation.html#compounds"><i class="fa fa-check"></i><b>4.3.3</b> Compounds</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="componentization.html"><a href="componentization.html"><i class="fa fa-check"></i><b>4.4</b> Componentization</a><ul>
<li class="chapter" data-level="4.4.1" data-path="componentization.html"><a href="componentization.html#features-with-similar-chromatographic-behaviour"><i class="fa fa-check"></i><b>4.4.1</b> Features with similar chromatographic behaviour</a></li>
<li class="chapter" data-level="4.4.2" data-path="componentization.html"><a href="componentization.html#homologues-series"><i class="fa fa-check"></i><b>4.4.2</b> Homologues series</a></li>
<li class="chapter" data-level="4.4.3" data-path="componentization.html"><a href="componentization.html#intclust"><i class="fa fa-check"></i><b>4.4.3</b> Intensity clustering</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="processing-workflow-data.html"><a href="processing-workflow-data.html"><i class="fa fa-check"></i><b>5</b> Processing workflow data</a><ul>
<li class="chapter" data-level="5.1" data-path="inspecting-results.html"><a href="inspecting-results.html"><i class="fa fa-check"></i><b>5.1</b> Inspecting results</a></li>
<li class="chapter" data-level="5.2" data-path="filtering.html"><a href="filtering.html"><i class="fa fa-check"></i><b>5.2</b> Filtering</a><ul>
<li class="chapter" data-level="5.2.1" data-path="filtering.html"><a href="filtering.html#features-1"><i class="fa fa-check"></i><b>5.2.1</b> Features</a></li>
<li class="chapter" data-level="5.2.2" data-path="filtering.html"><a href="filtering.html#annotation-1"><i class="fa fa-check"></i><b>5.2.2</b> Annotation</a></li>
<li class="chapter" data-level="5.2.3" data-path="filtering.html"><a href="filtering.html#components"><i class="fa fa-check"></i><b>5.2.3</b> Components</a></li>
<li class="chapter" data-level="5.2.4" data-path="filtering.html"><a href="filtering.html#negation"><i class="fa fa-check"></i><b>5.2.4</b> Negation</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="subset.html"><a href="subset.html"><i class="fa fa-check"></i><b>5.3</b> Subsetting</a><ul>
<li class="chapter" data-level="5.3.1" data-path="subset.html"><a href="subset.html#prioritization-workflow"><i class="fa fa-check"></i><b>5.3.1</b> Prioritization workflow</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="unOv.html"><a href="unOv.html"><i class="fa fa-check"></i><b>5.4</b> Unique and overlapping features</a></li>
<li class="chapter" data-level="5.5" data-path="visualization.html"><a href="visualization.html"><i class="fa fa-check"></i><b>5.5</b> Visualization</a><ul>
<li class="chapter" data-level="5.5.1" data-path="visualization.html"><a href="visualization.html#vis_feat_ann"><i class="fa fa-check"></i><b>5.5.1</b> Features and annatation data</a></li>
<li class="chapter" data-level="5.5.2" data-path="visualization.html"><a href="visualization.html#visComp"><i class="fa fa-check"></i><b>5.5.2</b> Comparing data</a></li>
<li class="chapter" data-level="5.5.3" data-path="visualization.html"><a href="visualization.html#plotClust"><i class="fa fa-check"></i><b>5.5.3</b> Hierarchical clustering results</a></li>
<li class="chapter" data-level="5.5.4" data-path="visualization.html"><a href="visualization.html#interactive-plotting-of-chromatography-data"><i class="fa fa-check"></i><b>5.5.4</b> Interactive plotting of chromatography data</a></li>
<li class="chapter" data-level="5.5.5" data-path="visualization.html"><a href="visualization.html#generating-eics-in-dataanalysis"><i class="fa fa-check"></i><b>5.5.5</b> Generating EICs in DataAnalysis</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="report.html"><a href="report.html"><i class="fa fa-check"></i><b>5.6</b> Reporting</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="advanced-usage.html"><a href="advanced-usage.html"><i class="fa fa-check"></i><b>6</b> Advanced usage</a><ul>
<li class="chapter" data-level="6.1" data-path="adducts.html"><a href="adducts.html"><i class="fa fa-check"></i><b>6.1</b> Adducts</a></li>
<li class="chapter" data-level="6.2" data-path="fOpt.html"><a href="fOpt.html"><i class="fa fa-check"></i><b>6.2</b> Feature parameter optimization</a><ul>
<li class="chapter" data-level="6.2.1" data-path="fOpt.html"><a href="fOpt.html#parameter-sets"><i class="fa fa-check"></i><b>6.2.1</b> Parameter sets</a></li>
<li class="chapter" data-level="6.2.2" data-path="fOpt.html"><a href="fOpt.html#processing-optmization-results"><i class="fa fa-check"></i><b>6.2.2</b> Processing optmization results</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="exporting-and-converting-feature-data.html"><a href="exporting-and-converting-feature-data.html"><i class="fa fa-check"></i><b>6.3</b> Exporting and converting feature data</a></li>
<li class="chapter" data-level="6.4" data-path="consensus.html"><a href="consensus.html"><i class="fa fa-check"></i><b>6.4</b> Algorithm consensus</a></li>
<li class="chapter" data-level="6.5" data-path="compclust.html"><a href="compclust.html"><i class="fa fa-check"></i><b>6.5</b> Compound clustering</a></li>
<li class="chapter" data-level="6.6" data-path="basic-quantitative-and-regression-analysis.html"><a href="basic-quantitative-and-regression-analysis.html"><i class="fa fa-check"></i><b>6.6</b> Basic quantitative and regression analysis</a></li>
<li class="chapter" data-level="6.7" data-path="caching.html"><a href="caching.html"><i class="fa fa-check"></i><b>6.7</b> Caching</a></li>
<li class="chapter" data-level="6.8" data-path="parallelization.html"><a href="parallelization.html"><i class="fa fa-check"></i><b>6.8</b> Parallelization</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">patRoon handbook</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="componentization" class="section level2">
<h2><span class="header-section-number">4.4</span> Componentization</h2>
<p>In <code>patRoon</code> <em>componentization</em> refers to grouping related feature groups together in components. Currently there are three different methodologies to generate components:</p>
<ul>
<li>Similarity on chromatographic elution profiles: feature groups with similar chromatographic behaviour which are assuming to be the same chemical compound (e.g. adducts or isotopologues).</li>
<li>Homologous series: features with increasing <em>m/z</em> and retention time.</li>
<li>Intensity profiles: features that follow a similar intensity profile in the analyses.</li>
</ul>
<p>The following algorithms are currently supported:</p>
<table>
<colgroup>
<col width="17%" />
<col width="43%" />
<col width="38%" />
</colgroup>
<thead>
<tr class="header">
<th>Algorithm</th>
<th>Usage</th>
<th>Remarks</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="http://msbi.ipb-halle.de/msbi/CAMERA/">CAMERA</a></td>
<td><code>generateComponents(algorithm = &quot;camera&quot;, ...)</code></td>
<td>Clusters feature groups with similar chromatographic elution profiles and annotate by known chemical rules (adducts, isotopologues, in-source fragments).</td>
</tr>
<tr class="even">
<td><a href="https://github.com/sneumann/RAMClustR">RAMClustR</a></td>
<td><code>generateComponents(algorithm = &quot;ramclustr&quot;, ...)</code></td>
<td>As above.</td>
</tr>
<tr class="odd">
<td><a href="https://cran.r-project.org/web/packages/nontarget/index.html">nontarget</a></td>
<td><code>generateComponents(algorithm = &quot;nontarget&quot;, ...)</code></td>
<td>Uses the <a href="https://cran.r-project.org/web/packages/nontarget/index.html">nontarget</a> R package to perform unsupervised homologous series detection.</td>
</tr>
<tr class="even">
<td>Intensity clustering</td>
<td><code>generateComponents(algorithm = &quot;intclust&quot;, ...)</code></td>
<td>Groups features with similar intensity profiles across analyses by hierarchical clustering.</td>
</tr>
</tbody>
</table>
<blockquote>
<p><strong><em>NOTE</em></strong> Componentization is a complex process and currently still in a relative young development phase. As such, its functionality and interface are planned to be further improved and results obtained now should always be manually checked, for instance, by using the <a href="report.html#report">reporting functions</a>.</p>
</blockquote>
<div id="features-with-similar-chromatographic-behaviour" class="section level3">
<h3><span class="header-section-number">4.4.1</span> Features with similar chromatographic behaviour</h3>
<p>Isotopes, adducts and in-source fragments typically result in detection of multiple mass peaks by the mass spectrometer for a single chemical compound. While some feature finding algorithms already try to collapse (some of) these in to a single feature, this process is often incomplete (if performed at all) and it is not uncommon that multiple features will describe the same compound. To overcome this complexity the algorithms from <a href="http://msbi.ipb-halle.de/msbi/CAMERA/">CAMERA</a> and <a href="https://github.com/sneumann/RAMClustR">RAMClustR</a> can be used to group features that undergo highly similar chromatographic behaviour but have different <em>m/z</em> values. Basic chemical rules are then applied to the resulting components to annotate adducts, in-source fragments and isotopologues, which may be highly useful for general identification purposes.</p>
<p>Some common function arguments to <code>generateComponents()</code> are listed below. Note that careful tuning for some of these is required to obtain useful results. In our experience the current default settings may significantly 'over-cluster' features that (clearly visibly) do not belong to each other. For this reason, you are advised to optimize and verify the various parameters supported by both algorithms. For a complete listing all arguments see the reference manual (e.g. <code>?generateComponents</code>).</p>
<table style="width:100%;">
<colgroup>
<col width="23%" />
<col width="20%" />
<col width="55%" />
</colgroup>
<thead>
<tr class="header">
<th>Argument</th>
<th>Algorithm</th>
<th>Remarks</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>ionization</code></td>
<td><code>&quot;camera&quot;</code>, <code>&quot;ramclustr&quot;</code></td>
<td>Ionization mode: <code>&quot;positive&quot;</code> or <code>&quot;negative&quot;</code></td>
</tr>
<tr class="even">
<td><code>minSize</code></td>
<td><code>&quot;camera&quot;</code>, <code>&quot;ramclustr&quot;</code></td>
<td>Minimum component size. Smaller components will be removed.</td>
</tr>
<tr class="odd">
<td><code>relMinReplicates</code></td>
<td><code>&quot;camera&quot;</code>, <code>&quot;ramclustr&quot;</code></td>
<td>See below.</td>
</tr>
<tr class="even">
<td><code>st</code>, <code>sr</code>, <code>maxt</code>, <code>hmax</code></td>
<td><code>&quot;ramclustr&quot;</code></td>
<td>Common parameters to influence clustering of <a href="https://github.com/sneumann/RAMClustR">RAMClustR</a>. See <code>?ramclustR</code> for details.</td>
</tr>
<tr class="odd">
<td><code>extraOpts</code></td>
<td><code>&quot;camera&quot;</code></td>
<td>A list with extra argument passed to the <code>annotate()</code> function from <a href="http://msbi.ipb-halle.de/msbi/CAMERA/">CAMERA</a>.</td>
</tr>
<tr class="even">
<td><code>extraOptsRC</code>, <code>extraOptsFM</code></td>
<td><code>&quot;ramclustr&quot;</code></td>
<td>A list with extra arguments passed to the <code>ramclustR()</code> and <code>do.findmain()</code> functions from <a href="https://github.com/sneumann/RAMClustR">RAMClustR</a>.</td>
</tr>
</tbody>
</table>
<p>Note that both algorithms were primarily designed for datasets where features are generally present in the majority of the analyses (as is relatively common in metabolomics). For environmental analyses, however, this is often not the case. As a result, it may happen that not all features from the feature groups within a component share their presence in the same analyses. In reality, this situation would be fairly unusual, and it is likely that such features actually do not belong to the same component. An extra filter option was added to improve such scenarios: after componentization all features are checked to have a minimal presence across all analyses within the component. This is configured by the <code>relMinReplicates</code> argument of <code>generateComponents()</code>, which specifies the relative number of replicate groups in which a feature should be present. For instance, when this value is <em>0.5</em> (the default), a feature must be present in at least half of all replicate groups present in the component.</p>
<p>Some example usage is shown below.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Use CAMERA with defaults</span>
componCAM &lt;-<span class="st"> </span><span class="kw">generateComponents</span>(fGroups, <span class="st">&quot;camera&quot;</span>, <span class="dt">ionization =</span> <span class="st">&quot;positive&quot;</span>)

<span class="co"># CAMERA with customized settings</span>
componCAM2 &lt;-<span class="st"> </span><span class="kw">generateComponents</span>(fGroups, <span class="st">&quot;camera&quot;</span>, <span class="dt">ionization =</span> <span class="st">&quot;positive&quot;</span>,
                                 <span class="dt">extraOpts =</span> <span class="kw">list</span>(<span class="dt">mzabs =</span> <span class="fl">0.001</span>, <span class="dt">sigma =</span> <span class="dv">5</span>))

<span class="co"># Use RAMClustR with customized parameters</span>
componRC &lt;-<span class="st"> </span><span class="kw">generateComponents</span>(fGroups, <span class="st">&quot;ramclustr&quot;</span>, <span class="dt">ionization =</span> <span class="st">&quot;positive&quot;</span>, <span class="dt">hmax =</span> <span class="fl">0.4</span>,
                               <span class="dt">extraOptsRC =</span> <span class="kw">list</span>(<span class="dt">cor.method =</span> <span class="st">&quot;spearman&quot;</span>),
                               <span class="dt">extraOptsFM =</span> <span class="kw">list</span>(<span class="dt">ppm.error =</span> <span class="dv">5</span>))</code></pre></div>
</div>
<div id="homologues-series" class="section level3">
<h3><span class="header-section-number">4.4.2</span> Homologues series</h3>
<p>Homologues series can be automatically detected by interfacing with the <a href="https://cran.r-project.org/web/packages/nontarget/index.html">nontarget</a> R package. Components are made from feature groups that show increasing <em>m/z</em> and retention time values. Series are first detected within each replicate group. Afterwards, series from all replicates are linked in case (partial) overlap occurs and this overlap consists of the <em>same</em> feature groups (see figure below). Linked series are then finally merged if this will not cause any conflicts with other series: such a conflict typically occurs when two series are not only linked to each other.</p>
<div class="figure"><span id="fig:HS"></span>
<div id="htmlwidget-7fae04c2a83d88ec460a" style="width:600px;height:250px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-7fae04c2a83d88ec460a">{"x":{"diagram":"\ndigraph Homologs {\n  graph [ rankdir = LR, compound = true, style = invis ]\n  node [ shape = oval,\n         fixedsize = true,\n         width = 2.3,\n         height = 0.8,\n         fontsize = 25,\n         fillcolor = darkseagreen1,\n         style = filled ]\n\n  subgraph cluster3 {\n    I [fillcolor=skyblue]; J [fillcolor=skyblue]; K [fillcolor=skyblue]\n    G -> H -> I -> J -> K [style=invis]\n  }\n\n  subgraph cluster4 {\n    _I [label=I, fillcolor=skyblue]; X [fillcolor=indianred1]; _K [label=K, fillcolor=skyblue]\n    _I -> X -> _K -> L [style=invis]\n  }\n\n  H -> _I [ltail=cluster3, lhead=cluster4, style=invis]\n  \n  I -> _I [constraint=false, style=dashed, arrowhead=none]\n  K -> _K [constraint=false, style=dashed, arrowhead=none]\n  \n  subgraph cluster1 {\n    C [fillcolor=skyblue]; D [fillcolor=skyblue]\n    A -> B -> C -> D [style=invis]\n  }\n\n  subgraph cluster2 {\n    _C [label=C, fillcolor=skyblue]; _D [label=D, fillcolor=skyblue]\n    _C -> _D -> E -> F [style=invis]\n  }\n  \n  B -> _C [ltail=cluster1, lhead=cluster2, style=invis]\n\n  C -> _C [constraint=false, style=dashed, arrowhead=none]\n  D -> _D [constraint=false, style=dashed, arrowhead=none]\n}","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
<p class="caption">
Figure 4.1: <strong>Linking of homologues series</strong> top: partial overlap and will be linked; bottom: no linkage due to different feature in overlapping series.
</p>
</div>
<p>The series that are linked can be interactively explored with the <code>plotGraph()</code> function (discussed <a href="visualization.html#vis_feat_ann">here</a>).</p>
<p>Common function arguments to <code>generateComponents()</code> are listed below.</p>
<table>
<colgroup>
<col width="22%" />
<col width="77%" />
</colgroup>
<thead>
<tr class="header">
<th>Argument</th>
<th>Remarks</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>ionization</code></td>
<td>Ionization mode: <code>&quot;positive&quot;</code> or <code>&quot;negative&quot;</code></td>
</tr>
<tr class="even">
<td><code>rtRange</code>, <code>mzRange</code></td>
<td>Retention and <em>m/z</em> increment range. Retention times can be negative to allow series with increasing <em>m/z</em> values and decreasing retention times.</td>
</tr>
<tr class="odd">
<td><code>elements</code></td>
<td>Vector with elements to consider.</td>
</tr>
<tr class="even">
<td><code>rtDev</code>, <code>absMzDev</code></td>
<td>Maximum retention time and <em>m/z</em> deviation.</td>
</tr>
<tr class="odd">
<td><code>extraOpts</code></td>
<td>List with extra arguments passed to the <code>homol.search()</code> function.</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># default settings</span>
componNT &lt;-<span class="st"> </span><span class="kw">generateComponents</span>(fGroups, <span class="st">&quot;nontarget&quot;</span>, <span class="dt">ionization =</span> <span class="st">&quot;positive&quot;</span>)

<span class="co"># customized settings</span>
componNT2 &lt;-<span class="st"> </span><span class="kw">generateComponents</span>(fGroups, <span class="st">&quot;nontarget&quot;</span>, <span class="dt">ionization =</span> <span class="st">&quot;positive&quot;</span>,
                                <span class="dt">elements =</span> <span class="kw">c</span>(<span class="st">&quot;C&quot;</span>, <span class="st">&quot;H&quot;</span>), <span class="dt">rtRange =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">60</span>, <span class="dv">60</span>))</code></pre></div>
</div>
<div id="intclust" class="section level3">
<h3><span class="header-section-number">4.4.3</span> Intensity clustering</h3>
<!-- UNDONE: refs? -->
<p>Whereas previous componentization methods utilized chemical properties to relate features, intensity clustering uses a statistical approach. This methodology is especially useful to find features that show similar trends in the analysed samples. Intensities for all features are first normalized and thereafter hierarchical clustering is performed to find features that show similar intensity profiles across analyses. Components are then formed from automatically assigned clusters (using the <a href="https://cran.r-project.org/package=dynamicTreeCut">dynamicTreeCut</a> R package, however, assignment can be changed afterwards).</p>
<p>Some common arguments to <code>generateComponents()</code> are listed below. It is recommended to test various settings (especially for <code>method</code>) to optimize the clustering results.</p>
<table>
<colgroup>
<col width="36%" />
<col width="13%" />
<col width="50%" />
</colgroup>
<thead>
<tr class="header">
<th>Argument</th>
<th>Default</th>
<th>Remarks</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>method</code></td>
<td><code>&quot;complete&quot;</code></td>
<td>Clustering method. See <code>?hclust</code></td>
</tr>
<tr class="even">
<td><code>metric</code></td>
<td><code>&quot;euclidean&quot;</code></td>
<td>Metric used to calculate the distance matrix. See <code>?daisy</code>.</td>
</tr>
<tr class="odd">
<td><code>normFunc</code></td>
<td><code>max</code></td>
<td>Function used to normalize data. Feature intensities within a feature group are divided by the result of when this function is called with their intensity values.</td>
</tr>
<tr class="even">
<td><code>average</code></td>
<td><code>TRUE</code></td>
<td>Whether intensities of replicates should first be averaged.</td>
</tr>
<tr class="odd">
<td><code>maxTreeHeight</code>, <code>deepSplit</code>, <code>minModuleSize</code></td>
<td><code>1</code>, <code>TRUE</code>, <code>1</code></td>
<td>Used for dynamic cluster assignment. See <code>?cutreeDynamicTree</code>.</td>
</tr>
</tbody>
</table>
<p>The resulting components are stored in an object from the <code>componentsIntClust</code> S4 class. Several methods are defined that can be used on such objects to re-assign clusters, perform plotting operations and so on. Below are some examples. For plotting see the relevant <a href="visualization.html#plotClust">visualization section</a>. More info can be found in the reference manual (e.g. <code>?componentsIntClust</code>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># generate components with default settings</span>
componInt &lt;-<span class="st"> </span><span class="kw">generateComponents</span>(fGroups, <span class="st">&quot;intclust&quot;</span>)

<span class="co"># manually re-assign clusters</span>
componInt &lt;-<span class="st"> </span><span class="kw">treeCut</span>(componInt, <span class="dt">k =</span> <span class="dv">10</span>)

<span class="co"># automatic re-assignment of clusters (adjusted max tree height)</span>
componInt &lt;-<span class="st"> </span><span class="kw">treeCutDynamic</span>(componInt, <span class="dt">maxTreeHeight =</span> <span class="fl">0.7</span>)</code></pre></div>

</div>
</div>
<!-- </div> -->
            </section>

          </div>
        </div>
      </div>
<a href="annotation.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="processing-workflow-data.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": false
}
});
});
</script>

</body>

</html>
